<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Innovation Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --info-color: #17a2b8;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --dark-bg: #121212;
            --dark-card: #1e1e1e;
            --dark-text: #ffffff;
        }
        
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: all 0.3s ease;
        }
        
        body.dark-theme {
            background-color: var(--dark-bg);
            color: var(--dark-text);
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), #0056b3);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .card {
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
            border: none;
        }
        
        .dark-theme .card {
            background-color: var(--dark-card);
            color: var(--dark-text);
            box-shadow: 0 4px 12px rgba(255,255,255,0.1);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .innovation-card {
            border-left: 4px solid var(--primary-color);
            background: linear-gradient(to right, rgba(0,123,255,0.03), transparent);
            cursor: pointer;
        }
        
        .prediction-card {
            border-left: 4px solid var(--warning-color);
            background: linear-gradient(to right, rgba(255,193,7,0.03), transparent);
            cursor: pointer;
        }
        
        .trend-up {
            color: var(--success-color);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .sector-badge {
            font-size: 0.8rem;
            padding: 0.3rem 0.6rem;
            border-radius: 20px;
        }
        
        .search-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
        }
        
        .dark-theme .search-section {
            background: var(--dark-card);
        }
        
        .stat-card {
            text-align: center;
            padding: 1.5rem;
            background: white;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .dark-theme .stat-card {
            background: var(--dark-card);
        }
        
        .stat-card:hover {
            background: linear-gradient(135deg, var(--primary-color), #0056b3);
            color: white;
        }
        
        .stat-card:hover .stat-number,
        .stat-card:hover .stat-label {
            color: white !important;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .dark-theme .stat-number {
            color: #4da6ff;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--secondary-color);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .dark-theme .stat-label {
            color: #cccccc;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }
        
        .btn-gradient {
            background: linear-gradient(135deg, var(--primary-color), #0056b3);
            color: white;
            border: none;
            transition: all 0.3s ease;
        }
        
        .btn-gradient:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,123,255,0.4);
            color: white;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            z-index: 9999;
            animation: slideIn 0.5s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .loading-spinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            background: rgba(0,0,0,0.8);
            padding: 2rem;
            border-radius: 15px;
            color: white;
        }
        
        .loading-spinner.active {
            display: block;
        }
        
        .api-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 20px;
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .dark-theme .api-status {
            background: var(--dark-card);
            color: var(--dark-text);
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: blink 2s infinite;
        }
        
        .status-dot.online {
            background: var(--success-color);
        }
        
        .status-dot.offline {
            background: var(--danger-color);
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            .chart-container {
                height: 300px;
            }
            .search-section {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="text-center">
            <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="mt-3">กำลังโหลดข้อมูล...</div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-4 fw-bold">
                        <i class="bi bi-globe"></i> Global Innovation Dashboard
                    </h1>
                    <p class="lead">ติดตามการเคลื่อนไหวของนวัตกรรมโลกและการประเมินมูลค่าทางเศรษฐกิจ</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <div class="btn-group mb-2" role="group">
                        <button type="button" class="btn btn-light" onclick="refreshData()">
                            <i class="bi bi-arrow-repeat"></i> รีเฟรช
                        </button>
                        <button type="button" class="btn btn-outline-light" onclick="toggleTheme()">
                            <i class="bi bi-moon" id="themeIcon"></i> <span id="themeText">ธีมมืด</span>
                        </button>
                        <button type="button" class="btn btn-outline-light" onclick="exportAllCharts()">
                            <i class="bi bi-download"></i> Export กราฟ
                        </button>
                    </div>
                    <div>
                        <small class="text-light">อัพเดทล่าสุด: <span id="lastUpdate">กำลังโหลด...</span></small>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Stats Overview -->
        <div class="row mb-4">
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="card stat-card" onclick="animateStatCard(this)">
                    <div class="stat-number" id="totalInnovations">10</div>
                    <div class="stat-label">นวัตกรรมปัจจุบัน</div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="card stat-card" onclick="animateStatCard(this)">
                    <div class="stat-number" id="totalPredictions">5</div>
                    <div class="stat-label">การคาดการณ์อนาคต</div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="card stat-card" onclick="animateStatCard(this)">
                    <div class="stat-number" id="totalValue">$1.2T</div>
                    <div class="stat-label">มูลค่าทางเศรษฐกิจ</div>
                </div>
            </div>
            <div class="col-md-3 col-sm-6 mb-3">
                <div class="card stat-card" onclick="animateStatCard(this)">
                    <div class="stat-number" id="totalSectors">9</div>
                    <div class="stat-label">สาขาอุตสาหกรรม</div>
                </div>
            </div>
        </div>

        <!-- Search Section -->
        <div class="search-section">
            <h3><i class="bi bi-search"></i> ค้นหานวัตกรรม</h3>
            <div class="row">
                <div class="col-md-6">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control form-control-lg" id="searchInput" 
                               placeholder="ค้นหาจากชื่อ คำอธิบาย หรือสาขา..." 
                               onkeyup="handleSearchInput(event)">
                        <button class="btn btn-gradient btn-lg" type="button" onclick="searchInnovations()">
                            <i class="bi bi-search"></i> ค้นหา
                        </button>
                    </div>
                </div>
                <div class="col-md-3">
                    <select class="form-select form-select-lg" id="sectorFilter" onchange="filterBySector()">
                        <option value="">ทุกสาขา</option>
                        <option value="Healthcare">Healthcare</option>
                        <option value="Technology">Technology</option>
                        <option value="Agriculture">Agriculture</option>
                        <option value="Energy">Energy</option>
                        <option value="Transportation">Transportation</option>
                        <option value="Environment">Environment</option>
                        <option value="Logistics">Logistics</option>
                        <option value="Manufacturing">Manufacturing</option>
                        <option value="Telecommunications">Telecommunications</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-outline-secondary btn-lg w-100" onclick="clearFilters()">
                        <i class="bi bi-x-circle"></i> ล้างตัวกรอง
                    </button>
                </div>
            </div>
            <div id="searchResults" class="mt-3"></div>
        </div>

        <!-- Current Innovations -->
        <section class="mb-5">
            <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">
                <h2><i class="bi bi-lightning"></i> นวัตกรรมปัจจุบัน</h2>
                <div class="btn-group" role="group">
                    <button class="btn btn-sm btn-outline-primary" onclick="sortByValue()">เรียงตามมูลค่า</button>
                    <button class="btn btn-sm btn-outline-secondary" onclick="sortByName()">เรียงตามชื่อ</button>
                    <button class="btn btn-sm btn-outline-info" onclick="sortByGrowth()">เรียงตามการเติบโต</button>
                    <button class="btn btn-sm btn-outline-success" onclick="toggleChart('innovation')">แสดง/ซ่อน กราฟ</button>
                </div>
            </div>
            
            <div class="row" id="innovationsContainer">
                <!-- Innovation cards will be inserted here -->
            </div>
            
            <!-- Growth Chart -->
            <div class="card mt-4" id="innovationChartCard">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5><i class="bi bi-bar-chart"></i> การเติบโตของนวัตกรรมปัจจุบัน</h5>
                    <div class="btn-group" role="group">
                        <button class="btn btn-sm btn-outline-primary" onclick="exportChartAsImage('innovationGrowthChart')">
                            <i class="bi bi-image"></i> Export รูป
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="exportChartAsPDF('innovationGrowthChart')">
                            <i class="bi bi-file-pdf"></i> Export PDF
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="innovationGrowthChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Future Predictions -->
        <section class="mb-5">
            <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">
                <h2><i class="bi bi-graph-up"></i> การประเมินการเคลื่อนไหวของนวัตกรรม 4-5 ปีข้างหน้า</h2>
                <div>
                    <span class="badge bg-warning text-dark">AI-Powered Predictions</span>
                    <button class="btn btn-sm btn-outline-warning ms-2" onclick="toggleChart('prediction')">แสดง/ซ่อน กราฟ</button>
                </div>
            </div>
            
            <div class="row" id="predictionsContainer">
                <!-- Prediction cards will be inserted here -->
            </div>
            
            <!-- Predictions Chart -->
            <div class="card mt-4" id="predictionChartCard">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5><i class="bi bi-graph-up-arrow"></i> การเคลื่อนไหวของนวัตกรรมในอนาคต 4-5 ปี</h5>
                    <div class="btn-group" role="group">
                        <button class="btn btn-sm btn-outline-primary" onclick="exportChartAsImage('futurePredictionsChart')">
                            <i class="bi bi-image"></i> Export รูป
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="exportChartAsPDF('futurePredictionsChart')">
                            <i class="bi bi-file-pdf"></i> Export PDF
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="futurePredictionsChart"></canvas>
                    </div>
                </div>
            </div></div>
        </section>
    </div>

    <!-- API Status Indicator -->
    <div class="api-status" id="apiStatus" onclick="showConnectionInfo()">
        <span class="status-dot offline"></span>
        <span id="statusText">Demo Mode</span>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="bi bi-globe"></i> Global Innovation Tracker</h5>
                    <p>ระบบติดตามและวิเคราะห์การเคลื่อนไหวของนวัตกรรมโลก</p>
                    <p>
                        <a href="https://github.com/netipoch-pro/Global-Innovation" class="text-light">
                            <i class="bi bi-github"></i> View on GitHub
                        </a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p>ข้อมูลอัปเดตล่าสุด: <span id="footerUpdate">-</span></p>
                    <p>Powered by AI Gemini & Claude</p>
                    <div class="mt-2">
                        <small class="text-muted">
                            © 2025 Global Innovation Dashboard. 
                            Made with ❤️ for tracking global innovation trends.
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Enhanced data with realistic information
        const currentInnovations = [
            {
                id: 1,
                name: "AI-Powered Drug Discovery",
                description: "ใช้ปัญญาประดิษฐ์เพื่อเร่งการค้นพบยาใหม่ ลดเวลาการพัฒนาจาก 10-15 ปี เหลือ 3-5 ปี",
                sector: "Healthcare",
                economicValue: "$50B",
                trend: "กำลังเติบโต",
                growth: 85,
                companies: ["DeepMind", "Atomwise", "Recursion"],
                impact: "High"
            },
            {
                id: 2,
                name: "Quantum Computing Breakthrough",
                description: "ความก้าวหน้าในโปรเซสเซอร์ควอนตัมสำหรับการใช้งานเชิงพาณิชย์",
                sector: "Technology",
                economicValue: "$120B",
                trend: "กำลังเติบโต",
                growth: 92,
                companies: ["IBM", "Google", "Microsoft"],
                impact: "Very High"
            },
            {
                id: 3,
                name: "Vertical Farming Systems",
                description: "ระบบเกษตรแนวตั้งในเมืองเพื่อความมั่นคงทางอาหาร",
                sector: "Agriculture",
                economicValue: "$35B",
                trend: "กำลังเติบโต",
                growth: 65,
                companies: ["AeroFarms", "Plenty", "Bowery"],
                impact: "Medium"
            },
            {
                id: 4,
                name: "Fusion Energy Commercialization",
                description: "เครื่องปฏิกรณ์ฟิวชันเชิงพาณิชย์แรกเริ่มทำงาน",
                sector: "Energy",
                economicValue: "$200B",
                trend: "กำลังเติบโต",
                growth: 78,
                companies: ["Commonwealth Fusion", "TAE Technologies"],
                impact: "Very High"
            },
            {
                id: 5,
                name: "Brain-Computer Interfaces",
                description: "อินเทอร์เฟซสมองกับคอมพิวเตอร์โดยตรงสำหรับการแพทย์และผู้บริโภค",
                sector: "Healthcare",
                economicValue: "$80B",
                trend: "กำลังเติบโต",
                growth: 70,
                companies: ["Neuralink", "Synchron", "Kernel"],
                impact: "High"
            },
            {
                id: 6,
                name: "Autonomous Vehicle Networks",
                description: "ระบบขนส่งอัตโนมัติเต็มรูปแบบในเมืองใหญ่",
                sector: "Transportation",
                economicValue: "$150B",
                trend: "กำลังเติบโต",
                growth: 88,
                companies: ["Waymo", "Tesla", "Cruise"],
                impact: "Very High"
            },
            {
                id: 7,
                name: "Carbon Capture Megastructures",
                description: "โครงสร้างขนาดใหญ่สำหรับจับคาร์บอนจากบรรยากาศ",
                sector: "Environment",
                economicValue: "$90B",
                trend: "กำลังเติบโต",
                growth: 72,
                companies: ["Climeworks", "Carbon Engineering"],
                impact: "High"
            },
            {
                id: 8,
                name: "Space-Based Solar Power",
                description: "แผงโซลาร์เซลล์บนวงโคจรส่งพลังงานมายังโลก",
                sector: "Energy",
                economicValue: "$180B",
                trend: "กำลังเติบโต",
                growth: 60,
                companies: ["Space Solar", "Caltech"],
                impact: "High"
            },
            {
                id: 9,
                name: "Personalized Genetic Medicine",
                description: "การรักษาที่ปรับแต่งตามโปรไฟล์พันธุกรรมของแต่ละบุคคล",
                sector: "Healthcare",
                economicValue: "$75B",
                trend: "กำลังเติบโต",
                growth: 83,
                companies: ["Illumina", "23andMe", "Foundation Medicine"],
                impact: "High"
            },
            {
                id: 10,
                name: "Blockchain Supply Chains",
                description: "ระบบติดตามห่วงโซ่อุปทานแบบโปร่งใสและปลอดภัย",
                sector: "Logistics",
                economicValue: "$45B",
                trend: "กำลังเติบโต",
                growth: 55,
                companies: ["Walmart", "Maersk", "De Beers"],
                impact: "Medium"
            }
        ];

        const futurePredictions = [
            {
                id: 1,
                name: "Neural Lace Technology",
                description: "เทคโนโลยีการฝังอุปกรณ์ในสมองเพื่อเพิ่มประสิทธิภาพการรับรู้",
                sector: "Healthcare",
                predictedValue: "$500B",
                timeframe: "4-5 ปีข้างหน้า",
                probability: 75
            },
            {
                id: 2,
                name: "Molecular Assemblers",
                description: "นาโนเทคโนโลยีสำหรับสร้างวัสดุตามต้องการ",
                sector: "Manufacturing",
                predictedValue: "$1.2T",
                timeframe: "4-5 ปีข้างหน้า",
                probability: 60
            },
            {
                id: 3,
                name: "Atmospheric Water Generation",
                description: "อุปกรณ์ที่สกัดน้ำดื่มจากอากาศในทุกสภาพอากาศ",
                sector: "Environment",
                predictedValue: "$300B",
                timeframe: "4-5 ปีข้างหน้า",
                probability: 85
            },
            {
                id: 4,
                name: "Holographic Communication",
                description: "ระบบการสื่อสารโฮโลแกรม 3D แบบเรียลไทม์",
                sector: "Telecommunications",
                predictedValue: "$250B",
                timeframe: "4-5 ปีข้างหน้า",
                probability: 70
            },
            {
                id: 5,
                name: "Biological Age Reversal",
                description: "การรักษาที่ย้อนกลับกระบวนการแก่ชราอย่างมีนัยสำคัญ",
                sector: "Healthcare",
                predictedValue: "$800B",
                timeframe: "4-5 ปีข้างหน้า",
                probability: 50
            }
        ];

        // Global variables
        let innovationChart = null;
        let predictionChart = null;
        let currentTheme = 'light';
        let currentInnovationsFiltered = [...currentInnovations];

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            showLoadingSkeleton();
            
            setTimeout(() => {
                initializeApp();
            }, 1000);
        });

        function initializeApp() {
            renderInnovations();
            renderPredictions();
            initCharts();
            updateStats();
            updateLastUpdateTime();
            
            // Hide loading spinner
            document.getElementById('loadingSpinner').classList.remove('active');
            
            // Load saved theme
            const savedTheme = localStorage.getItem('dashboard-theme');
            if (savedTheme === 'dark') {
                toggleTheme();
            }
            
            showNotification('ยินดีต้อนรับสู่ Global Innovation Dashboard!', 'success');
        }

        function showLoadingSkeleton() {
            document.getElementById('loadingSpinner').classList.add('active');
            
            const skeleton = `
                <div class="col-md-6 col-lg-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <div class="placeholder-glow">
                                <span class="placeholder col-7 mb-2"></span>
                                <span class="placeholder col-4 mb-2"></span>
                                <span class="placeholder col-12 mb-2"></span>
                                <span class="placeholder col-6"></span>
                            </div>
                        </div>
                    </div>
                </div>
            `.repeat(6);
            
            document.getElementById('innovationsContainer').innerHTML = skeleton;
            document.getElementById('predictionsContainer').innerHTML = skeleton;
        }

        function updateStats() {
            const sectors = [...new Set(currentInnovations.map(i => i.sector))];
            const totalEconomicValue = currentInnovations.reduce((sum, item) => {
                const value = parseFloat(item.economicValue.replace(/[^0-9.]/g, ''));
                return sum + value;
            }, 0);
            
            document.getElementById('totalInnovations').textContent = currentInnovations.length;
            document.getElementById('totalPredictions').textContent = futurePredictions.length;
            document.getElementById('totalValue').textContent = `${totalEconomicValue.toFixed(1)}T`;
            document.getElementById('totalSectors').textContent = sectors.length;
        }

        function renderInnovations(innovations = currentInnovationsFiltered) {
            const container = document.getElementById('innovationsContainer');
            container.innerHTML = innovations.map(innovation => `
                <div class="col-md-6 col-lg-4 mb-3 fade-in">
                    <div class="card innovation-card h-100" onclick="showInnovationDetails(${innovation.id})">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <h5 class="card-title">${innovation.name}</h5>
                                <span class="badge bg-${getImpactColor(innovation.impact)} ms-2">${innovation.impact}</span>
                            </div>
                            <span class="badge bg-primary sector-badge mb-2">${innovation.sector}</span>
                            <p class="card-text">${innovation.description}</p>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div>
                                    <span class="text-muted">มูลค่า:</span>
                                    <strong class="text-success">${innovation.economicValue}</strong>
                                </div>
                                <span class="trend-up">
                                    <i class="bi bi-arrow-up"></i> ${innovation.trend}
                                </span>
                            </div>
                            <div class="progress mb-2" style="height: 5px;">
                                <div class="progress-bar bg-success" style="width: ${innovation.growth || 70}%"></div>
                            </div>
                            <small class="text-muted">การเติบโต: ${innovation.growth || 70}%</small>
                            ${innovation.companies ? `
                                <div class="mt-2">
                                    <small class="text-muted">บริษัทชั้นนำ: ${innovation.companies.slice(0, 2).join(', ')}</small>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderPredictions(predictions = futurePredictions) {
            const container = document.getElementById('predictionsContainer');
            container.innerHTML = predictions.map(prediction => `
                <div class="col-md-6 col-lg-4 mb-3 fade-in">
                    <div class="card prediction-card h-100" onclick="showPredictionDetails(${prediction.id})">
                        <div class="card-body">
                            <h5 class="card-title">${prediction.name}</h5>
                            <span class="badge bg-warning text-dark sector-badge mb-2">${prediction.sector}</span>
                            <p class="card-text">${prediction.description}</p>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div>
                                    <span class="text-muted">มูลค่าที่คาดการณ์:</span>
                                    <strong class="text-warning">${prediction.predictedValue}</strong>
                                </div>
                                <span class="text-muted">${prediction.timeframe}</span>
                            </div>
                            <div class="mt-2">
                                <div class="d-flex justify-content-between">
                                    <small class="text-muted">ความน่าจะเป็น:</small>
                                    <small class="fw-bold">${prediction.probability || 70}%</small>
                                </div>
                                <div class="progress" style="height: 5px;">
                                    <div class="progress-bar bg-warning" style="width: ${prediction.probability || 70}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getImpactColor(impact) {
            switch(impact) {
                case 'Very High': return 'danger';
                case 'High': return 'warning';
                case 'Medium': return 'info';
                case 'Low': return 'secondary';
                default: return 'primary';
            }
        }

        function initCharts() {
            // Innovation Growth Chart
            const ctx1 = document.getElementById('innovationGrowthChart').getContext('2d');
            innovationChart = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: currentInnovations.map(i => i.name.length > 20 ? i.name.substring(0, 20) + '...' : i.name),
                    datasets: [{
                        label: 'อัตราการเติบโต (%)',
                        data: currentInnovations.map(i => i.growth || Math.floor(Math.random() * 40) + 50),
                        backgroundColor: 'rgba(0, 123, 255, 0.7)',
                        borderColor: 'rgba(0, 123, 255, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true
                        },
                        title: {
                            display: true,
                            text: 'อัตราการเติบโตของนวัตกรรมปัจจุบัน (%)',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'อัตราการเติบโต (%)'
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45
                            }
                        }
                    }
                }
            });

            // Future Predictions Chart - เปลี่ยนเป็น Line Chart
            const ctx2 = document.getElementById('futurePredictionsChart').getContext('2d');
            
            // สร้างข้อมูลสำหรับ timeline 4-5 ปีข้างหน้า
            const years = ['2025', '2026', '2027', '2028', '2029'];
            const predictionData = futurePredictions.map(prediction => {
                const baseValue = parseFloat(prediction.predictedValue.replace(/[^0-9.]/g, ''));
                const probability = prediction.probability / 100;
                
                // สร้างเส้นโค้งการเติบโตตามความน่าจะเป็น
                return years.map((year, index) => {
                    const yearFactor = (index + 1) / 5; // 0.2, 0.4, 0.6, 0.8, 1.0
                    const growthFactor = Math.pow(probability, 0.5); // ปรับค่าตามความน่าจะเป็น
                    return baseValue * yearFactor * growthFactor;
                });
            });

            const colors = [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)', 
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)'
            ];

            const backgroundColors = [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)'
            ];

            predictionChart = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: futurePredictions.map((prediction, index) => ({
                        label: prediction.name,
                        data: predictionData[index],
                        borderColor: colors[index],
                        backgroundColor: backgroundColors[index],
                        borderWidth: 3,
                        fill: false,
                        tension: 0.4,
                        pointBackgroundColor: colors[index],
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'การคาดการณ์มูลค่าทางเศรษฐกิจของนวัตกรรมในอนาคต 4-5 ปี',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function(context) {
                                    return 'ปี ' + context[0].label;
                                },
                                label: function(context) {
                                    const prediction = futurePredictions[context.datasetIndex];
                                    return [
                                        `${context.dataset.label}: ${context.parsed.y.toFixed(0)}B`,
                                        `ความน่าจะเป็น: ${prediction.probability}%`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: 'ปี (ค.ศ.)'
                            },
                            grid: {
                                display: true
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,
                                text: 'มูลค่าทางเศรษฐกิจ (พันล้านดอลลาร์)'
                            },
                            beginAtZero: true,
                            grid: {
                                display: true
                            }
                        }
                    },
                    elements: {
                        point: {
                            hoverBorderWidth: 3
                        }
                    }
                }
            });
        }

        function handleSearchInput(event) {
            if (event.key === 'Enter') {
                searchInnovations();
            } else {
                clearTimeout(window.searchTimeout);
                window.searchTimeout = setTimeout(searchInnovations, 300);
            }
        }

        function searchInnovations() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const sector = document.getElementById('sectorFilter').value;
            
            let filtered = currentInnovations.filter(i => {
                const matchesQuery = !query || 
                    i.name.toLowerCase().includes(query) || 
                    i.description.toLowerCase().includes(query) ||
                    i.sector.toLowerCase().includes(query) ||
                    (i.companies && i.companies.some(c => c.toLowerCase().includes(query)));
                
                const matchesSector = !sector || i.sector === sector;
                
                return matchesQuery && matchesSector;
            });
            
            currentInnovationsFiltered = filtered;
            renderInnovations(filtered);
            
            const resultDiv = document.getElementById('searchResults');
            if (query || sector) {
                if (filtered.length > 0) {
                    resultDiv.innerHTML = 
                        `<div class="alert alert-success"><i class="bi bi-check-circle"></i> พบ ${filtered.length} รายการ</div>`;
                } else {
                    resultDiv.innerHTML = 
                        `<div class="alert alert-warning"><i class="bi bi-exclamation-triangle"></i> ไม่พบข้อมูลที่ค้นหา</div>`;
                }
            } else {
                resultDiv.innerHTML = '';
            }
        }

        function filterBySector() {
            searchInnovations();
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('sectorFilter').value = '';
            document.getElementById('searchResults').innerHTML = '';
            currentInnovationsFiltered = [...currentInnovations];
            renderInnovations();
            showNotification('ล้างตัวกรองเรียบร้อย', 'info');
        }

        function sortByValue() {
            const sorted = [...currentInnovationsFiltered].sort((a, b) => {
                const aVal = parseFloat(a.economicValue.replace(/[^0-9.]/g, ''));
                const bVal = parseFloat(b.economicValue.replace(/[^0-9.]/g, ''));
                return bVal - aVal;
            });
            currentInnovationsFiltered = sorted;
            renderInnovations(sorted);
            showNotification('เรียงตามมูลค่าเรียบร้อย', 'success');
        }

        function sortByName() {
            const sorted = [...currentInnovationsFiltered].sort((a, b) => a.name.localeCompare(b.name));
            currentInnovationsFiltered = sorted;
            renderInnovations(sorted);
            showNotification('เรียงตามชื่อเรียบร้อย', 'success');
        }

        function sortByGrowth() {
            const sorted = [...currentInnovationsFiltered].sort((a, b) => (b.growth || 0) - (a.growth || 0));
            currentInnovationsFiltered = sorted;
            renderInnovations(sorted);
            showNotification('เรียงตามการเติบโตเรียบร้อย', 'success');
        }

        function toggleChart(type) {
            const card = type === 'innovation' ? 
                document.getElementById('innovationChartCard') : 
                document.getElementById('predictionChartCard');
            
            if (card.style.display === 'none') {
                card.style.display = 'block';
                card.style.opacity = '0';
                setTimeout(() => {
                    card.style.opacity = '1';
                }, 10);
            } else {
                card.style.opacity = '0';
                setTimeout(() => {
                    card.style.display = 'none';
                }, 300);
            }
        }

        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.getElementById('themeText');
            
            if (currentTheme === 'light') {
                body.classList.add('dark-theme');
                themeIcon.className = 'bi bi-sun';
                themeText.textContent = 'ธีมสว่าง';
                currentTheme = 'dark';
                localStorage.setItem('dashboard-theme', 'dark');
            } else {
                body.classList.remove('dark-theme');
                themeIcon.className = 'bi bi-moon';
                themeText.textContent = 'ธีมมืด';
                currentTheme = 'light';
                localStorage.setItem('dashboard-theme', 'light');
            }
            
            showNotification(`เปลี่ยนเป็น${currentTheme === 'dark' ? 'ธีมมืด' : 'ธีมสว่าง'}เรียบร้อย`, 'info');
        }

        function animateStatCard(element) {
            element.style.transform = 'scale(1.1)';
            setTimeout(() => {
                element.style.transform = 'scale(1)';
            }, 200);
        }

        function showInnovationDetails(id) {
            const innovation = currentInnovations.find(i => i.id === id);
            if (!innovation) return;
            
            const modalHtml = `
                <div class="modal fade" tabindex="-1" id="innovationModal">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title"><i class="bi bi-lightning"></i> ${innovation.name}</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6>รายละเอียด</h6>
                                        <p>${innovation.description}</p>
                                        <p><strong>สาขา:</strong> ${innovation.sector}</p>
                                        <p><strong>มูลค่าทางเศรษฐกิจ:</strong> ${innovation.economicValue}</p>
                                        <p><strong>การเติบโต:</strong> ${innovation.growth}%</p>
                                        <p><strong>ผลกระทบ:</strong> <span class="badge bg-${getImpactColor(innovation.impact)}">${innovation.impact}</span></p>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>บริษัทชั้นนำ</h6>
                                        <ul class="list-group list-group-flush">
                                            ${innovation.companies ? innovation.companies.map(company => 
                                                `<li class="list-group-item">${company}</li>`
                                            ).join('') : '<li class="list-group-item">ไม่มีข้อมูล</li>'}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Remove existing modal
            const existingModal = document.getElementById('innovationModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            const modal = new bootstrap.Modal(document.getElementById('innovationModal'));
            modal.show();
            
            document.getElementById('innovationModal').addEventListener('hidden.bs.modal', function() {
                this.remove();
            });
        }

        function showPredictionDetails(id) {
            const prediction = futurePredictions.find(p => p.id === id);
            if (!prediction) return;
            
            const modalHtml = `
                <div class="modal fade" tabindex="-1" id="predictionModal">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title"><i class="bi bi-graph-up"></i> ${prediction.name}</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h6>รายละเอียดการคาดการณ์</h6>
                                        <p>${prediction.description}</p>
                                        <p><strong>สาขา:</strong> ${prediction.sector}</p>
                                        <p><strong>มูลค่าที่คาดการณ์:</strong> ${prediction.predictedValue}</p>
                                        <p><strong>ระยะเวลา:</strong> ${prediction.timeframe}</p>
                                        <p><strong>ความน่าจะเป็น:</strong> ${prediction.probability}%</p>
                                        
                                        <div class="progress mt-2">
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: ${prediction.probability}%" 
                                                 aria-valuenow="${prediction.probability}" aria-valuemin="0" aria-valuemax="100">
                                                ${prediction.probability}%
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Remove existing modal
            const existingModal = document.getElementById('predictionModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            const modal = new bootstrap.Modal(document.getElementById('predictionModal'));
            modal.show();
            
            document.getElementById('predictionModal').addEventListener('hidden.bs.modal', function() {
                this.remove();
            });
        }

        function refreshData() {
            showNotification('กำลังรีเฟรชข้อมูล...', 'info');
            
            setTimeout(() => {
                // Simulate data refresh with small changes
                currentInnovations.forEach(innovation => {
                    innovation.growth = Math.max(30, Math.min(95, innovation.growth + (Math.random() - 0.5) * 10));
                });
                
                futurePredictions.forEach(prediction => {
                    prediction.probability = Math.max(40, Math.min(90, prediction.probability + (Math.random() - 0.5) * 5));
                });
                
                // Re-render everything
                renderInnovations();
                renderPredictions();
                updateStats();
                updateLastUpdateTime();
                
                // Update charts
                if (innovationChart) {
                    innovationChart.data.datasets[0].data = currentInnovations.map(i => i.growth);
                    innovationChart.update();
                }
                
                if (predictionChart) {
                    // Update prediction chart with new data
                    const years = ['2025', '2026', '2027', '2028', '2029'];
                    const predictionData = futurePredictions.map(prediction => {
                        const baseValue = parseFloat(prediction.predictedValue.replace(/[^0-9.]/g, ''));
                        const probability = prediction.probability / 100;
                        
                        return years.map((year, index) => {
                            const yearFactor = (index + 1) / 5;
                            const growthFactor = Math.pow(probability, 0.5);
                            return baseValue * yearFactor * growthFactor;
                        });
                    });
                    
                    predictionChart.data.datasets.forEach((dataset, index) => {
                        dataset.data = predictionData[index];
                    });
                    predictionChart.update();
                }
                
                showNotification('ข้อมูลได้รับการอัพเดทแล้ว', 'success');
            }, 1000);
        }

        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('th-TH', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('lastUpdate').textContent = timeString;
            document.getElementById('footerUpdate').textContent = timeString;
        }

        function showConnectionInfo() {
            showNotification('กำลังทำงานในโหมดสาธิต - ข้อมูลที่แสดงเป็นตัวอย่าง', 'info');
        }

        function showNotification(message, type = 'info') {
            const colors = {
                success: '#28a745',
                error: '#dc3545',
                warning: '#ffc107',
                info: '#17a2b8'
            };
            
            const icons = {
                success: 'bi-check-circle',
                error: 'bi-x-circle',
                warning: 'bi-exclamation-triangle',
                info: 'bi-info-circle'
            };
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.backgroundColor = colors[type];
            notification.style.color = type === 'warning' ? '#000' : '#fff';
            notification.innerHTML = `
                <i class="bi ${icons[type]} me-2"></i>
                ${message}
                <button type="button" class="btn-close btn-close-${type === 'warning' ? 'dark' : 'white'} ms-2" onclick="this.parentElement.remove()"></button>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.style.opacity = '0';
                    setTimeout(() => {
                        notification.remove();
                    }, 300);
                }
            }, 5000);
        }

        // Export chart functions
        function exportChartAsImage(chartId) {
            const canvas = document.getElementById(chartId);
            const chart = Chart.getChart(canvas);
            
            if (!chart) {
                showNotification('ไม่พบกราฟที่ต้องการ export', 'error');
                return;
            }

            try {
                // Create a temporary canvas with white background
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                
                tempCanvas.width = canvas.width;
                tempCanvas.height = canvas.height;
                
                // Fill with white background
                tempCtx.fillStyle = '#ffffff';
                tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                
                // Draw the chart on top
                tempCtx.drawImage(canvas, 0, 0);
                
                // Convert to image and download
                const imageURL = tempCanvas.toDataURL('image/png', 1.0);
                const link = document.createElement('a');
                link.download = `${chartId}_${new Date().getTime()}.png`;
                link.href = imageURL;
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showNotification('Export รูปภาพเรียบร้อย', 'success');
            } catch (error) {
                console.error('Export error:', error);
                showNotification('เกิดข้อผิดพลาดในการ export รูปภาพ', 'error');
            }
        }

        function exportChartAsPDF(chartId) {
            const canvas = document.getElementById(chartId);
            const chart = Chart.getChart(canvas);
            
            if (!chart) {
                showNotification('ไม่พบกราฟที่ต้องการ export', 'error');
                return;
            }

            try {
                // Create a new window for PDF generation
                const printWindow = window.open('', '_blank');
                
                // Get chart title
                const chartTitle = chart.options.plugins?.title?.text || 'กราฟ Global Innovation Dashboard';
                
                // Create a temporary canvas with white background
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                
                tempCanvas.width = canvas.width;
                tempCanvas.height = canvas.height;
                
                // Fill with white background
                tempCtx.fillStyle = '#ffffff';
                tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
                
                // Draw the chart on top
                tempCtx.drawImage(canvas, 0, 0);
                
                const imageURL = tempCanvas.toDataURL('image/png', 1.0);
                
                const pdfContent = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>${chartTitle}</title>
                        <style>
                            body {
                                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                margin: 0;
                                padding: 20px;
                                background: white;
                            }
                            .header {
                                text-align: center;
                                margin-bottom: 30px;
                                border-bottom: 2px solid #007bff;
                                padding-bottom: 20px;
                            }
                            .header h1 {
                                color: #007bff;
                                margin: 0;
                                font-size: 24px;
                            }
                            .header p {
                                color: #666;
                                margin: 10px 0 0 0;
                                font-size: 14px;
                            }
                            .chart-container {
                                text-align: center;
                                margin: 20px 0;
                            }
                            .chart-title {
                                font-size: 18px;
                                font-weight: bold;
                                margin-bottom: 20px;
                                color: #333;
                            }
                            .chart-image {
                                max-width: 100%;
                                height: auto;
                                border: 1px solid #ddd;
                                border-radius: 8px;
                                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                            }
                            .metadata {
                                margin-top: 30px;
                                padding-top: 20px;
                                border-top: 1px solid #eee;
                                font-size: 12px;
                                color: #666;
                            }
                            .metadata table {
                                width: 100%;
                                border-collapse: collapse;
                            }
                            .metadata td {
                                padding: 5px 10px;
                                border: 1px solid #eee;
                            }
                            .metadata td:first-child {
                                background: #f8f9fa;
                                font-weight: bold;
                                width: 150px;
                            }
                            @media print {
                                body { print-color-adjust: exact; }
                                .no-print { display: none; }
                            }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h1>Global Innovation Dashboard</h1>
                            <p>ระบบติดตามและวิเคราะห์การเคลื่อนไหวของนวัตกรรมโลก</p>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-title">${chartTitle}</div>
                            <img src="${imageURL}" alt="${chartTitle}" class="chart-image">
                        </div>
                        
                        <div class="metadata">
                            <h3>ข้อมูลรายงาน</h3>
                            <table>
                                <tr>
                                    <td>วันที่สร้างรายงาน</td>
                                    <td>${new Date().toLocaleDateString('th-TH', {
                                        year: 'numeric',
                                        month: 'long', 
                                        day: 'numeric',
                                        hour: '2-digit',
                                        minute: '2-digit'
                                    })}</td>
                                </tr>
                                <tr>
                                    <td>ประเภทกราฟ</td>
                                    <td>${chart.config.type === 'bar' ? 'แผนภูมิแท่ง' : 
                                         chart.config.type === 'line' ? 'แผนภูมิเส้น' : 
                                         chart.config.type === 'radar' ? 'แผนภูมิเรดาร์' : 'อื่นๆ'}</td>
                                </tr>
                                <tr>
                                    <td>จำนวนข้อมูล</td>
                                    <td>${chart.data.labels.length} รายการ</td>
                                </tr>
                                <tr>
                                    <td>แหล่งข้อมูล</td>
                                    <td>Global Innovation Dashboard - AI-Powered Analysis</td>
                                </tr>
                                <tr>
                                    <td>การใช้งาน</td>
                                    <td>เอกสารนี้สร้างขึ้นสำหรับการวิเคราะห์และนำเสนอข้อมูลนวัตกรรมโลก</td>
                                </tr>
                            </table>
                        </div>

                        <div style="margin-top: 40px; text-align: center; color: #999; font-size: 11px;">
                            © 2025 Global Innovation Dashboard - สร้างด้วย AI และเทคโนโลยีล้ำสมัย
                        </div>
                    </body>
                    </html>
                `;
                
                printWindow.document.write(pdfContent);
                printWindow.document.close();
                printWindow.focus();
                
                // Wait for image to load then print
                setTimeout(() => {
                    printWindow.print();
                    setTimeout(() => {
                        printWindow.close();
                    }, 1000);
                }, 500);
                
                showNotification('กำลังสร้าง PDF... กรุณารอสักครู่', 'info');
                
            } catch (error) {
                console.error('PDF export error:', error);
                showNotification('เกิดข้อผิดพลาดในการสร้าง PDF', 'error');
            }
        }

        // Enhanced export all charts function
        function exportAllCharts() {
            const charts = ['innovationGrowthChart', 'futurePredictionsChart'];
            let exportCount = 0;
            
            showNotification('กำลัง export กราฟทั้งหมด...', 'info');
            
            charts.forEach((chartId, index) => {
                setTimeout(() => {
                    exportChartAsImage(chartId);
                    exportCount++;
                    
                    if (exportCount === charts.length) {
                        setTimeout(() => {
                            showNotification('Export กราฟทั้งหมดเรียบร้อย', 'success');
                        }, 1000);
                    }
                }, index * 1000);
            });
        }
        document.addEventListener('keydown', function(event) {
            if ((event.ctrlKey || event.metaKey) && event.key === '/') {
                event.preventDefault();
                document.getElementById('searchInput').focus();
            }
            
            if ((event.ctrlKey || event.metaKey) && event.key === 'r') {
                event.preventDefault();
                refreshData();
            }
            
            if ((event.ctrlKey || event.metaKey) && event.key === 'd') {
                event.preventDefault();
                toggleTheme();
            }
            
            if (event.key === 'Escape') {
                clearFilters();
            }
        });

        // Auto-refresh every 5 minutes
        setInterval(() => {
            refreshData();
        }, 300000);

        console.log('🚀 Global Innovation Dashboard initialized successfully!');
        console.log('📊 Features: Search, Filter, Sort, Charts, Dark Theme');
        console.log('⌨️ Keyboard shortcuts: Ctrl+/ (search), Ctrl+R (refresh), Ctrl+D (theme), Esc (clear)');
    </script>
</body>
</html>